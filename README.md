# אלגוריתם פאקמן – Ex3Algo

מסמך זה מתאר את האלגוריתם של פאקמן. בכל צעד פאקמן בוחן את מצב הלוח, מזהה מהו המהלך החשוב ביותר באותו רגע, ובוחר את כיוון התנועה בהתאם.

האלגוריתם מבוסס על חישובי מרחקים בעזרת BFS (`allDistance`) ועל מציאת מסלולים קצרים (`shortestPath`), כפי שמומשו במטלה הקודמת (Ex2).

---

## הרעיון הכללי

בכל צעד פאקמן יכול לנוע לאחד מארבעה כיוונים: למעלה, למטה, ימינה או שמאלה.  
ההחלטה לאיזה כיוון לזוז מתקבלת לפי ארבעה מצבים, המוגדרים על פי צבעים בלוח:

- **ורוד** – נקודות רגילות שצריך לאכול (המטרה הראשית)
- **שחור** – מפלצת מסוכנת שצריך לברוח ממנה
- **לבן** – מפלצת שאפשר לאכול
- **ירוק** – נקודת כוח שהופכת את המפלצות לאכילות לזמן מוגבל

האלגוריתם פועל לפי סדר עדיפויות ברור, כאשר הישרדות קודמת לכל.

---

## חישובים שמבוצעים בכל צעד

בכל צעד האלגוריתם מבצע את הפעולות הבאות:

1. קורא את מיקום פאקמן ואת מצב הלוח הנוכחי.
2. מחשב מפת מרחקים באמצעות:
allDistance(pacmanPosition, BLUE)
במפת המרחקים כל תא מכיל את מספר הצעדים המינימלי הנדרש כדי להגיע אליו ממיקום פאקמן, מבלי לעבור דרך קירות (BLUE).  
תאים שלא ניתן להגיע אליהם מקבלים ערך ‎-1.

---

## מצב 1 – שחור (בריחה ממפלצת)

### מתי נכנסים למצב זה?
- קיימת מפלצת שחורה (שאינה אכילה).
- המרחק שלה מפאקמן קטן מ־8 משבצות.

### מה פאקמן עושה?
- בוחר כיוון תנועה שמגדיל את המרחק בינו לבין המפלצת השחורה הקרובה ביותר.

זהו המצב בעל העדיפות הגבוהה ביותר, והוא מבטל כל מצב אחר.

---

## מצב 2 – ורוד (אכילת נקודות רגילות)

### מתי נכנסים למצב זה?
- אין סכנה מיידית ממפלצות שחורות.

### מה פאקמן עושה?
- מאתר את הנקודה הוורודה הקרובה ביותר.
- מחשב מסלול קצר אליה.
- מתקדם צעד אחד לאורך המסלול.

### המטרה:
לאכול את כל הנקודות הוורודות ולסיים את המשחק.

---

## מצב 3 – ירוק (נקודת כוח)

### מתי נכנסים למצב זה?
- קיימת נקודה ירוקה על המפה.
- אין מפלצת שחורה קרובה שמסכנת את פאקמן.

### מה פאקמן עושה?
- מתקדם לעבר הנקודה הירוקה הקרובה ביותר לפי מפת המרחקים.
- זז צעד אחד לכיוון הנקודה.

### המטרה:
להפוך מפלצות מסוכנות למפלצות אכילות ולאפשר תנועה בטוחה יותר על הלוח.

---

## מצב 4 – לבן (אכילת מפלצת)

### מתי נכנסים למצב זה?
- פאקמן אכל נקודה ירוקה, וכל המפלצות לבנות.
- קיימת מפלצת לבנה שניתן לאכול.
- הזמן שנותר למפלצת להיות אכילה מספיק כדי שפאקמן יוכל להגיע אליה.

### מה פאקמן עושה?
- מחשב מסלול קצר ביותר אל המפלצת הלבנה.
- מתקדם צעד אחד לאורך המסלול.

### המטרה:
להוריד מפלצות מהלוח לזמן קצר.  
אכילת מפלצות לבנות אינה מטרה בפני עצמה, אלא פעולה משנית בלבד.

---

## סדר עדיפויות בין המצבים

1. שחור – בריחה ממפלצת  
2. ורוד – אכילת נקודות רגילות (המטרה הראשית)  
3. ירוק – נקודת כוח  
4. לבן – אכילת מפלצת  

---

## מקרי קצה

- אובייקט שלא ניתן להגיע אליו (מרחק ‎-1) – מתעלמים ממנו.
- כאשר קיימות מספר מפלצות שחורות – מתייחסים רק לקרובה ביותר.
- אם אין כיוון שמגדיל מרחק במצב שחור – נבחר כיוון חוקי כלשהו.
- אם `shortestPath` מחזיר `null` – עוברים למצב הבא לפי סדר העדיפויות.
- אם אין נקודות ורודות על המפה – מנסים להגיע לנקודה ירוקה או מבצעים תנועה חוקית.

---
